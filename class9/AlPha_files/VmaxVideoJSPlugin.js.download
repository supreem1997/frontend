!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("videojs")):"function"==typeof define&&define.amd?define(["videojs"],t):"object"==typeof exports?exports.VmaxVideoJSPlugin=t(require("videojs")):e.VmaxVideoJSPlugin=t(e.videojs)}(this,(e=>(()=>{"use strict";var t={291:function(e,t,n){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(988)),r=i(n(882)),s=i(n(724)),d=n(793),l=function(){function e(){if(this._adsMap={},this._cuePoints=[],this._cuePointSelected=[],this._skippedCuePoints=[],this.previousCurrentTime=0,this._cuePointsAvailable=[],e._instance)throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");e._instance=this}return e.getInstance=function(){return e._instance},e.prototype.init=function(e,t){this.reset();var n=e.hasOwnProperty("ads")&&e.ads,a=n.hasOwnProperty("video_break")&&n.video_break;if(n||a){var i=n.hasOwnProperty("settings")&&n.settings.timeout||{};s.default.setTimeout(i),d.CSAIAdState.customData=s.default.parseAndPopulateCustomData(n),this.player=t,this.createAdsContainer(t),s.default.optimizeUX(this.adsContainer.id),this._cuePoints=Object.keys(a),this.createAdMap(a,t)}else console.warn("Video break details not provided")},e.prototype.createAdMap=function(e,t){this._adsMap=a(a({},this._adsMap),e),this._cuePointsAvailable=Object.keys(this._adsMap).map(Number),this._cuePointsAvailable=r.default.removeValuesFromArray(this._cuePointsAvailable,[0,-1]),this.addEvents(t);var n,i=function(){var e=s._adsMap[l];e.placementId=e.tagid,e.adspotKey=e.adspot_key,o.default.listenToAdEvents(e.placementId,t),s._adsMap[l].meta='{"cue-point":"'+l+'","pos":"{$}"}';var a={primaryList:[Object.assign({},s._adsMap[l])],playerAdsContainerId:s.playerAdsContainerId,currentMuteState:t.volume()};d.CSAIAdState.adsMap[l]={},n=e.hasOwnProperty("requested_ads")&&!isNaN(e.requested_ads)&&e.requested_ads%1==0&&e.requested_ads;var i=Array.apply(null,Array(n)).map((function(t){return e.tagid}));d.CSAIAdState.adsMap[l].adBreak=new VmaxAdBreak(i),d.CSAIAdState.adsMap[l].adBreak.setAdbreakvalues({customData:d.CSAIAdState.customData,breakArguments:a}),d.CSAIAdState.adsMap[l].adBreak.resumeContent((function(){console.log("!!player played"),d.CSAIAdState.contentPlayed=!0,t.play()})),d.CSAIAdState.adsMap[l].adBreak.playerPlay((function(){console.log("!!player played"),t.play()})),d.CSAIAdState.adsMap[l].adBreak.getKalturaMuteState((function(){return!t.volume()})),d.CSAIAdState.adsMap[l].adBreak.sort((function(e){var t=e;return r.default.adsSortFunction(t)}))},s=this;for(var l in e)i()},e.prototype.showAd=function(e){if(this._adsMap.hasOwnProperty(e)&&!this._cuePointSelected.includes(e)){console.log("Showing ad for cuePoint",e),s.default.setParamsForCompanionBehavior(this._adsMap[e]);var t=this.player.pause();void 0===t?this.pauseContentStartAdBreak(e):t.then(this.pauseContentStartAdBreak.bind(this,e))}},e.prototype.pauseContentStartAdBreak=function(e){d.CSAIAdState.contentPlayed=!1,setTimeout(this.contentPause.bind(this),300);var t=this.player.paused();console.log("!!played paused",t),d.CSAIAdState.adsMap[e].adBreak.start(this.adsContainer),0===e&&(d.CSAIAdState.prerollPlayed=!0),this._cuePointSelected.push(e),this._adsMap[e].AdShown=!0},e.prototype.contentPause=function(){console.log(">>>>>>>>>>>>> pausing player"),d.CSAIAdState.contentPlayed||this.player.pause()},e.prototype.addEvents=function(e){o.default.listenOnce("loadedmetadata",this.showAd.bind(this,0)),o.default.listen("timeupdate",this.pickMidRoll.bind(this,e)),o.default.listen("ended",this.showAd.bind(this,-1))},e.prototype.createAdsContainer=function(e){try{var t=Date.now()||(new Date).getTime(),n="ins_videos_container_"+t,a=document.createElement("div");a.id="player_ads_"+t;var i=document.createElement("div");i.id=n;var o=a.id;this.playerAdsContainerId=o;var r=document.createElement("style");r.type="text/css";var s=document.createTextNode("#"+o+"{ position: absolute; top: 0px; left: 0; right: 0; bottom: 0; display: none; background: black;}#"+o+".active{ display: block; z-index: 94;}#"+o+".loader{ display: block; z-index: 95; background: #000;}#"+o+".loader:after{ content:''; display: block; position: absolute; top: 50%; left: 50%; width: 40px; height: 40px; border: 4px solid rgb(147,0,183,1); border-radius: 50%; border-top-color: rgba(255, 255, 255, 0.001); animation: spin 0.6s ease-in-out infinite; -webkit-animation: spin 0.6s ease-in-out infinite; margin: -20px 0 0 -20px;} @keyframes spin { to { -webkit-transform: rotate(360deg); } } @-webkit-keyframes spin { to { -webkit-transform: rotate(360deg); }}");return r.appendChild(s),document.body.appendChild(r),this.player.el_.appendChild(a),this.adsContainer=d.CSAIAdState.adsContainer=a,document.body.appendChild(i),!0}catch(e){return console.error("Could not create adsContainer",e),!1}},e.prototype.pickMidRoll=function(e){var t=Math.floor(e.currentTime());this.previousCurrentTime,this.makeSkippedAdsAvailable(t);var n=this.getAvailableAdsForCurrentTime(t);!1!==n&&(this.playHighestCuePointAndSkipOthers(n),this.previousCurrentTime=t)},e.prototype.makeSkippedAdsAvailable=function(e){var t,n=this._skippedCuePoints.filter((function(t){return t>=e}));this._skippedCuePoints=r.default.removeValuesFromArray(this._skippedCuePoints,n),(t=this._cuePointsAvailable).push.apply(t,n)},e.prototype.getAvailableAdsForCurrentTime=function(e){var t=this;return this._cuePointsAvailable=r.default.removeValuesFromArray(this._cuePointsAvailable,this._skippedCuePoints),this._cuePointsAvailable.filter((function(n){return n<=e&&!t._cuePointSelected.includes(n)}))},e.prototype.playHighestCuePointAndSkipOthers=function(e){var t;if(!(e.length<=0)){var n=e.pop();(t=this._skippedCuePoints).push.apply(t,e),this.showAd(n)}},e.prototype.reset=function(){this._cuePointSelected=[],this._cuePointsAvailable=[],this._skippedCuePoints=[],this.previousCurrentTime=0,this.adsContainer&&this.adsContainer.remove(),this.playerAdsContainerId="",d.CSAIAdState.prerollPlayed=!1},e._instance=new e,e}().getInstance();t.default=l},432:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ad_request="adRequest",e.media_load="mediaLoad"}(n||(n={})),t.default=n},622:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e["3G"]="_3G",e["4G"]="_4G",e.cellular="cellular",e.wifi="wifi"}(n||(n={})),t.default=n},988:function(e,t,n){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(993),o=function(){function e(){if(this.eventsMap={},this.listener={},e._instance)throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");e._instance=this}return e.prototype.init=function(e){this.player=e,e.one("ended",this.dispatchVideoEvents.bind(this)),e.one("loadedmetadata",this.dispatchVideoEvents.bind(this)),e.on("timeupdate",this.dispatchVideoEvents.bind(this))},e.prototype.listenToAdEvents=function(e,t){Object.values(i.Constant.AdEvents).forEach((function(n){VMAXSDK.Events.listen(n,e,(function(e){t.trigger(a({type:n},e))}))}))},e.getInstance=function(){return e._instance},e.prototype.listen=function(e,t){this.eventsMap.hasOwnProperty(e)||(this.eventsMap[e]=[]),this.eventsMap[e].push(t)},e.prototype.listenOnce=function(e,t){this.eventsMap.hasOwnProperty(e)||(this.eventsMap[e]=[]),this.eventsMap[e].push(t)},e.prototype.dispatchVideoEvents=function(e){var t=e.hasOwnProperty("type")?e.type:e;if(t){var n=this.eventsMap.hasOwnProperty(t)&&this.eventsMap[t];n&&n.forEach((function(e){e()}))}},e.prototype.listenPlayerEventListeners=function(e,t,n){this.listener.hasOwnProperty(t)&&this.listener[t].includes(this.listener[t][0])||(this.listener.hasOwnProperty(t)||(this.listener[t]=[]),this.listener[t].push(n),e.addEventListener(t,n))},e.prototype.remove=function(e){delete this.eventsMap[e]},e._instance=new e,e}().getInstance();t.default=o},724:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(882)),o=n(461),r=a(n(622)),s=a(n(432)),d=n(633),l=function(){function e(){if(e._instance)throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");e._instance=this}return e.getInstance=function(){return e._instance},e.prototype.optimizeUX=function(e){try{VMAXSDK.AdBreakHelper.optimizeUX({container:document.getElementById(e),successCallback:function(){console.log("optimizeUX method created 'Ad Player' successfully!")},errorCallback:function(e){console.log("",e)}})}catch(e){console.error("Persistent Player Creation Failed")}},e.prototype.parseAndPopulateCustomData=function(e){try{return"object"==typeof e&&e instanceof Object&&e.hasOwnProperty("key_values")&&Object.keys(e.key_values).length>0?e.key_values:{}}catch(e){return{}}},e.prototype.setTimeout=function(e){if(Object.entries(e).length>0)for(var t in e)for(var n in e[t])i.default.validateInterval(e[t][n])||(e[t][n]=o.zee5TimeoutDefault[t][n]);var a=i.default.mergeObjects(o.zee5TimeoutDefault,e);for(var t in a)for(var n in a[t])VMAXSDK.VmaxTimeout.configure({connectionType:r.default[n],timeoutType:s.default[t],value:a[t][n]})},e.prototype.setParamsForCompanionBehavior=function(e){VMAXSDK.Companion.overrideParams={},this.setZee5DefaultCompanionParams(),this.setCompanionConfiguration(e)},e.prototype.setCompanionConfiguration=function(e){var t=e&&e.hasOwnProperty("adslots")&&e.adslots;t&&Object.keys(t).length>0&&VMAXSDK.Companion.updateCompanionConfiguration(t)},e.prototype.setZee5DefaultCompanionParams=function(){VMAXSDK.Companion.changeDefaultParams(d.zee5CompanionDefaultParams)},e.prototype.getCompanionParams=function(e){var t=Object.assign(e),n=JSON.stringify(t);return n=n.replace(/show_delay/gim,"showDelay").replace(/close_delay/gim,"closeDelay").replace(/hide_on_endcard/gim,"hideOnEndcard"),JSON.parse(n)},e._instance=new e,e}().getInstance();t.default=l},43:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(988)),o=n(793),r=function(){function e(){if(e._instance)throw new Error("Error: Instantiation failed: Use SingletonClass.getInstance() instead of new.");e._instance=this}return e.getInstance=function(){return e._instance},e.prototype.init=function(e,t){var n=e.hasOwnProperty("enableSSAITracking")&&e.enableSSAITracking;!1!==n&&(o.CSAIAdState.SSAIAds=!0,this.player=t,i.default.listenOnce("loadedmetadata",this.startSSAITracking.bind(this,n)))},e.prototype.startSSAITracking=function(e,t){var n=e.tracker,a=e.contentType,i=e.trackingUrl;if(this.tracker=n,n&&i){var o=n.Enums.PlayerEvents,r=this.getVideoElement();n.startTracking({video:r,contentType:a,trackingUrl:i}),this.SSAIPlayerEventListeners(o,n)}},e.prototype.getVideoElement=function(){return this.player.el_.querySelectorAll("video.vjs-tech")[0]},e.prototype.fireBeacon=function(e,t){e.track(t)},e.prototype.SSAIPlayerEventListeners=function(e,t){var n=this.getVideoElement();i.default.listenPlayerEventListeners(n,e.PAUSE,this.fireBeacon.bind(this,t,e.PAUSE)),i.default.listenPlayerEventListeners(n,"play",this.playingEventResume.bind(this,t,e)),i.default.listenPlayerEventListeners(n,"volumechange",this.volumeChangeEvent.bind(this,t,e)),i.default.listenPlayerEventListeners(n,"fullscreenchange",this.fullScreenChangeEvent.bind(this,t,e))},e.prototype.volumeChangeEvent=function(e,t){this.player.muted()?this.fireBeacon(e,t.MUTE):this.fireBeacon(e,t.UNMUTE)},e.prototype.fullScreenChangeEvent=function(e,t){this.player.isFullscreen()?this.fireBeacon(e,t.EXIT_FULLSCREEN):this.fireBeacon(e,t.ENTER_FULLSCREEN)},e.prototype.playingEventResume=function(e,t){this.fireBeacon(e,t.RESUME)},e.prototype.addAdEventListener=function(e,t){this.tracker.addAdEventListener(e,t)},e._instance=new e,e}().getInstance();t.default=r},793:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CSAIAdState=void 0,t.CSAIAdState={timeout:{},customData:{},adsMap:{},determineAdEvents:!1,player:{},prerollPlayed:!1,adsContainer:{},SSAIAds:!1,contentPlayed:!1}},882:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.validateInterval=function(e){return!isNaN(e)&&"number"==typeof e&&e%1==0&&e>0&&e},e.mergeObjects=function(t,n){return Object.entries(n).reduce((function(t,n){var a=n[0],i=n[1];return t[a]=i&&"object"==typeof i?e.mergeObjects(t[a]=t[a]||(Array.isArray(i)?[]:{}),i):i,t}),t)},e.adsSortFunction=function(e){return e.sort((function(e,t){return void 0===e.adInfo||e.adnetwork||void 0===e.adInfo.ad["playback-duration"]?1:void 0===t.adInfo||t.adnetwork||void 0===t.adInfo.ad["playback-duration"]?-1:e.adInfo.ad["playback-duration"]===t.adInfo.ad["playback-duration"]?0:e.adInfo.ad["playback-duration"]<t.adInfo.ad["playback-duration"]?-1:1}))},e.removeValuesFromArray=function(e,t){try{return e.filter((function(e){return!t.includes(e)}))}catch(t){return console.warn("Could not remove values from array!",t),e||[]}},e}();t.default=n},993:(e,t)=>{var n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.Constant=void 0,function(e){e.MUTED="MUTE",e.PLAY="PLAY",e.RESUME="RESUME",e.PAUSE="PAUSE",e.UNMUTE="UNMUTE"}(n||(n={})),function(e){e.AD_BREAK_START="onAdBreakStart",e.AD_BREAK_COMPLETE="onAdBreakComplete",e.AD_BREAK_READY="onAdBreakReady",e.AD_BREAK_ERROR="onAdBreakError",e.AD_READY="onAdReady",e.AD_ERROR="onAdError",e.AD_MEDIA_END="onAdMediaEnd",e.AD_SKIPPED="onAdSkipped",e.AD_MEDIA_START="onAdMediaStart",e.AD_MEDIA_PAUSE="onAdMediaPause",e.AD_MEDIA_RESUME="onAdMediaResume",e.AD_SKIPPABLE="onAdSkippable",e.AD_CLICK="onAdClick",e.AD_TIME_UPDATE="onAdTimeUpdate",e.AD_IMPRESSION="onAdImpression",e.AD_MEDIA_FIRST_QUARTILE="onAdMediaFirstQuartile",e.AD_MEDIA_MIDPOINT="onAdMediaMidpoint",e.AD_MEDIA_THIRDQUARTILE="onAdMediaThirdQuartile",e.AD_MEDIA_MUTE="onAdMediaMute",e.AD_MEDIA_UNMUTE="onAdMediaUnmute",e.AD_MEDIA_EXPAND="onAdMediaExpand",e.AD_MEDIA_COLLAPSE="onAdMediaCollapse",e.AD_CLOSE="onAdClose",e.AD_REFRESH="onAdRefresh",e.AD_RENDER="onAdRender",e.AD_LOADED="onAdLoaded"}(a||(a={})),t.Constant={VideoEvents:n,AdEvents:a}},633:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.zee5CompanionDefaultParams=void 0,t.zee5CompanionDefaultParams={DelayShowClose:{showDelay:0,closeDelay:5,hideOnEndcard:!0},CloseOnNextBreak:{showDelay:0,hideOnEndcard:!0}}},461:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.zee5TimeoutDefault=void 0,t.zee5TimeoutDefault={media_load:{"3G":7,"4G":7,wifi:5,cellular:7},ad_request:{"3G":5,"4G":5,wifi:4,cellular:5}}},315:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(889)),o=a(n(291)),r=a(n(43)),s=a(n(988)),d=(i.default.getPlugin("plugin"),{}),l=function(){function e(){}return e.prototype.updateConfig=function(e,t){var n=this;this.player=t,this.config=e,this.options=i.default.mergeOptions(d,e),this.player.ready((function(){n.player.addClass("vjs-example-plugin")})),this.player.on("loadstart",this.cleanUp.bind(this)),this.player.on("dispose",this.cleanUp.bind(this)),this.init.call(this,e,this.player)},e.prototype.cleanUp=function(){this.init(this.config,this.player)},e.prototype.init=function(e,t){console.log("VmaxVideoJS Plugin initialized"),e?(o.default.init(e,t),r.default.init(e,t),s.default.init(t)):console.error("Config not provided")},e}();t.default=l},607:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(147),o=a(n(315)),r=n(993),s=n(793),d=new o.default,l=function(e){this._VmaxVideoJSPlugin=d,d.updateConfig(e,this)};l.VERSION=i.version,l.AdEvents=r.Constant.AdEvents,console.log(s.CSAIAdState),l.getAdsContainer=function(){return s.CSAIAdState.adsContainer},t.default=l},889:t=>{t.exports=e},147:e=>{e.exports=JSON.parse('{"name":"vmax-video.js-plugin","version":"1.0.0","description":"","main":"index.ts","scripts":{"dev":"webpack-dev-server --live-reload --color","build:integration":"webpack && exit 0","cleanup:node-modules":"rm -rf node_modules && npm install"},"author":"","license":"ISC","devDependencies":{"@types/node":"^17.0.36","imports-loader":"^4.0.0","path":"^0.12.7","typescript":"^4.6.3","webpack":"^5.72.0","webpack-cli":"^4.9.2","webpack-dev-server":"^4.9.1","webpack-merge":"^5.8.0","webpack-node-externals":"^3.0.0"},"dependencies":{"ts-loader":"^9.2.9"}}')}},n={},a=function e(a){var i=n[a];if(void 0!==i)return i.exports;var o=n[a]={exports:{}};return t[a].call(o.exports,o,o.exports,e),o.exports}(607);return a.default})()));